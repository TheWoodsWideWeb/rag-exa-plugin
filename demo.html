<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Psybrary Modern UI Demo</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <style>
        body {
            background: #0C0012;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            color: #fff;
        }
        
        .demo-container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .demo-header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .demo-header h1 {
            font-size: 32px;
            margin-bottom: 8px;
            color: #3bb273;
        }
        
        .demo-header p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 16px;
        }
        
        .demo-search {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
        }
        
        .demo-search input {
            width: 100%;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 12px 16px;
            color: #fff;
            font-size: 16px;
            box-sizing: border-box;
        }
        
        .demo-search input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <div class="demo-header">
            <h1>🧠 Psybrary Modern UI</h1>
            <p>Experience the new dark-themed interface with enhanced functionality</p>
        </div>
        
        <div class="demo-search">
            <input type="text" placeholder="Ask a question about psychedelics..." value="Tell me about psychedelics">
        </div>
        
        <!-- Modern Answer Block -->
        <div class="answer-block modern-ui" id="demo-answer">
            <div class="answer-header">
                <h1 class="exa-user-question">Tell me about psychedelics</h1>
                <div class="answer-tabs">
                    <button class="tab-btn active" data-tab="answer">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="3"></circle>
                            <path d="M12 1v6m0 6v6"></path>
                        </svg>
                        Answer
                    </button>
                    <button class="tab-btn" data-tab="images">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <circle cx="8.5" cy="8.5" r="1.5"></circle>
                            <polyline points="21,15 16,10 5,21"></polyline>
                        </svg>
                        Images
                    </button>
                    <button class="tab-btn" data-tab="sources">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polygon points="12,2 15.09,8.26 22,9.27 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9.27 8.91,8.26"></polygon>
                        </svg>
                        Sources 10
                    </button>

                </div>
            </div>
            
            <div class="tab-content active" data-tab="answer">
                <div class="exa-results">
                    <div class="sources-header">
                        <span>📚 10 sources found</span>
                    </div>
                    <div class="sources-container">
                        <button class="slider-btn prev-btn">&#10094;</button>
                        <div class="top-sources-wrapper">
                            <div class="source-card">
                                <div class="source-card-header">
                                    <img src="https://www.google.com/s2/favicons?sz=64&domain=wikipedia.org" alt="favicon" class="exa-favicon">
                                    <span class="exa-domain">wikipedia.org</span>
                                </div>
                                <a href="#" class="source-title">Psychedelic drug - Wikipedia</a>
                            </div>
                            <div class="source-card">
                                <div class="source-card-header">
                                    <img src="https://www.google.com/s2/favicons?sz=64&domain=adf.org.au" alt="favicon" class="exa-favicon">
                                    <span class="exa-domain">adf.org.au</span>
                                </div>
                                <a href="#" class="source-title">Alcohol and Drug Foundation - Psychedelics</a>
                            </div>
                            <div class="source-card">
                                <div class="source-card-header">
                                    <img src="https://www.google.com/s2/favicons?sz=64&domain=americanaddictioncenters.org" alt="favicon" class="exa-favicon">
                                    <span class="exa-domain">americanaddictioncenters.org</span>
                                </div>
                                <a href="#" class="source-title">American Addiction Centers - Psychedelic Drugs</a>
                            </div>
                            <div class="source-card">
                                <div class="source-card-header">
                                    <img src="https://www.google.com/s2/favicons?sz=64&domain=health.gov.au" alt="favicon" class="exa-favicon">
                                    <span class="exa-domain">health.gov.au</span>
                                </div>
                                <a href="#" class="source-title">Department of Health - Psychedelic Substances</a>
                            </div>
                        </div>
                        <button class="slider-btn next-btn">&#10095;</button>
                    </div>
                </div>
                
                <div class="exa-answer-streaming space-owl-m">
                    <h2>Psychedelics Overview</h2>
                    <p>Psychedelics are a group of psychoactive substances that primarily alter perception, mood, and various cognitive processes. Also known as hallucinogens, their main effect is to trigger non-ordinary mental states, sometimes called psychedelic experiences or 'trips,' which can involve vivid sensory distortions and intense alterations in consciousness.</p>
                    
                    <h3>Key Characteristics</h3>
                    <ul>
                        <li><strong>Mechanism:</strong> Classic psychedelics primarily interact with serotonin receptors in the brain, particularly the 5-HT2A receptor, which plays a key role in regulating mood, perception, and cognition.</li>
                        <li><strong>Effects:</strong> Users may experience visual and auditory hallucinations, altered sense of time, enhanced emotional experiences, and profound spiritual or mystical experiences.</li>
                        <li><strong>Forms:</strong> Psychedelics can be naturally occurring (like psilocybin mushrooms and mescaline) or synthetic (like LSD and DMT).</li>
                        <li><strong>Common Substances:</strong> LSD, psilocybin (magic mushrooms), mescaline, DMT, and Ayahuasca are among the most well-known psychedelics.</li>
                    </ul>
                    
                    <h3>Therapeutic Potential and Risks</h3>
                    <ul>
                        <li><strong>Medical Research:</strong> Recent studies suggest potential therapeutic benefits for treating depression, anxiety, PTSD, and addiction, though research is still in early stages and legal restrictions apply.</li>
                        <li><strong>Risks:</strong> Potential for "bad trips" characterized by anxiety, paranoia, and lasting perceptual changes. Some users may experience flashbacks or persistent perceptual disorders.</li>
                        <li><strong>Set and Setting:</strong> The user's mindset and physical environment significantly influence the psychedelic experience, emphasizing the importance of proper preparation and safe environments.</li>
                    </ul>
                    
                    <h3>Historical and Cultural Context</h3>
                    <ul>
                        <li><strong>Traditional Use:</strong> Many psychedelics have been used in religious and spiritual rituals for thousands of years by various indigenous cultures worldwide.</li>
                        <li><strong>Modern Interest:</strong> There's a growing resurgence of interest in psychedelics for mental health treatment, leading to increased research and potential therapeutic applications.</li>
                    </ul>
                    
                    <p>In summary, psychedelics are powerful tools for altering human consciousness. They hold growing medical interest but also carry significant risks and require careful consideration of context, dosage, and individual vulnerability.</p>
                </div>
            </div>
            
            <div class="tab-content" data-tab="images">
                <div class="images-placeholder">Images will appear here</div>
            </div>
            
            <div class="tab-content" data-tab="sources">
                <div class="sources-content">
                    <div class="sources-tab-header">
                                            <div class="sources-count">
                        <span class="count-number">4</span>
                        <span class="count-label">Sources Found</span>
                    </div>
                        <div class="sources-filters">
                            <button class="filter-btn active" data-filter="all">All</button>
                            <button class="filter-btn" data-filter="recent">Recent</button>
                            <button class="filter-btn" data-filter="relevance">Relevance</button>
                        </div>
                    </div>
                    
                    <div class="source-item" data-index="0">
                        <div class="source-item-header">
                            <div class="source-favicon">
                                <img src="https://www.google.com/s2/favicons?sz=64&domain=wikipedia.org" alt="favicon">
                            </div>
                            <div class="source-info">
                                <div class="source-domain">wikipedia.org</div>
                                <div class="source-title">Psychedelic drug - Wikipedia</div>
                            </div>
                            <div class="source-actions">
                                <button class="source-action-btn" onclick="window.open('https://wikipedia.org', '_blank')" title="Open Source">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                                        <polyline points="15,3 21,3 21,9"></polyline>
                                        <line x1="10" y1="14" x2="21" y2="3"></line>
                                    </svg>
                                </button>
                                <button class="source-action-btn" onclick="copyToClipboard('https://wikipedia.org')" title="Copy URL">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="source-item-details">
                            <div class="source-url">
                                <a href="https://wikipedia.org" target="_blank" rel="noopener noreferrer">https://wikipedia.org</a>
                            </div>
                            <div class="source-snippet">Comprehensive information about psychedelic substances, their effects, and history.</div>
                        </div>
                    </div>
                    
                    <div class="source-item" data-index="1">
                        <div class="source-item-header">
                            <div class="source-favicon">
                                <img src="https://www.google.com/s2/favicons?sz=64&domain=adf.org.au" alt="favicon">
                            </div>
                            <div class="source-info">
                                <div class="source-domain">adf.org.au</div>
                                <div class="source-title">Alcohol and Drug Foundation - Psychedelics</div>
                            </div>
                            <div class="source-actions">
                                <button class="source-action-btn" onclick="window.open('https://adf.org.au', '_blank')" title="Open Source">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                                        <polyline points="15,3 21,3 21,9"></polyline>
                                        <line x1="10" y1="14" x2="21" y2="3"></line>
                                    </svg>
                                </button>
                                <button class="source-action-btn" onclick="copyToClipboard('https://adf.org.au')" title="Copy URL">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="source-item-details">
                            <div class="source-url">
                                <a href="https://adf.org.au" target="_blank" rel="noopener noreferrer">https://adf.org.au</a>
                            </div>
                            <div class="source-snippet">Evidence-based information about psychedelics and harm reduction approaches.</div>
                        </div>
                    </div>

                    <div class="source-item" data-index="2">
                        <div class="source-item-header">
                            <div class="source-favicon">
                                <img src="https://www.google.com/s2/favicons?sz=64&domain=erowid.org" alt="favicon">
                            </div>
                            <div class="source-info">
                                <div class="source-domain">erowid.org</div>
                                <div class="source-title">Erowid - Psychedelic Information</div>
                            </div>
                            <div class="source-actions">
                                <button class="source-action-btn" onclick="window.open('https://erowid.org', '_blank')" title="Open Source">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                                        <polyline points="15,3 21,3 21,9"></polyline>
                                        <line x1="10" y1="14" x2="21" y2="3"></line>
                                    </svg>
                                </button>
                                <button class="source-action-btn" onclick="copyToClipboard('https://erowid.org')" title="Copy URL">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="source-item-details">
                            <div class="source-url">
                                <a href="https://erowid.org" target="_blank" rel="noopener noreferrer">https://erowid.org</a>
                            </div>
                            <div class="source-snippet">Comprehensive database of psychoactive substances and their effects.</div>
                        </div>
                    </div>

                    <div class="source-item" data-index="3">
                        <div class="source-item-header">
                            <div class="source-favicon">
                                <img src="https://www.google.com/s2/favicons?sz=64&domain=psychedelicscience.org" alt="favicon">
                            </div>
                            <div class="source-info">
                                <div class="source-domain">psychedelicscience.org</div>
                                <div class="source-title">Multidisciplinary Association for Psychedelic Studies</div>
                            </div>
                            <div class="source-actions">
                                <button class="source-action-btn" onclick="window.open('https://psychedelicscience.org', '_blank')" title="Open Source">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                                        <polyline points="15,3 21,3 21,9"></polyline>
                                        <line x1="10" y1="14" x2="21" y2="3"></line>
                                    </svg>
                                </button>
                                <button class="source-action-btn" onclick="copyToClipboard('https://psychedelicscience.org')" title="Copy URL">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="source-item-details">
                            <div class="source-url">
                                <a href="https://psychedelicscience.org" target="_blank" rel="noopener noreferrer">https://psychedelicscience.org</a>
                            </div>
                            <div class="source-snippet">Research and education about psychedelics and their therapeutic potential.</div>
                        </div>
                    </div>
                </div>
            </div>
            

            
            <div class="answer-reaction-bar modern">
                <div class="action-buttons">
                    <button class="action-btn share-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M13 4v4c-6.575 1.028 -9.02 6.788 -10 12c-.037 .206 5.384 -5.962 10 -6v4l8 -7l-8 -7z"></path>
                        </svg>
                        Share
                    </button>

                    <button class="action-btn rewrite-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path>
                            <path d="M21 3v5h-5"></path>
                            <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path>
                            <path d="M3 21v-5h5"></path>
                        </svg>
                        Rewrite
                    </button>
                </div>
                <div class="reaction-buttons">
                    <span class="reaction-like">👍</span>
                    <span class="like-count">12</span>
                    <span class="reaction-dislike">👎</span>
                    <span class="dislike-count">2</span>

                    <span class="reaction-more">⋯</span>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        // Tab switching functionality
        $(document).on('click', '.tab-btn', function(e) {
            e.preventDefault();
            const tabName = $(this).data('tab');
            const answerBlock = $(this).closest('.answer-block');
            
            // Update active tab button
            answerBlock.find('.tab-btn').removeClass('active');
            $(this).addClass('active');
            
            // Update active tab content
            answerBlock.find('.tab-content').removeClass('active');
            answerBlock.find(`[data-tab="${tabName}"]`).addClass('active');
        });

        // Slider functionality
        document.querySelectorAll('.exa-results').forEach(block => {
            const wrapper = block.querySelector('.top-sources-wrapper');
            const prevBtn = block.querySelector('.prev-btn');
            const nextBtn = block.querySelector('.next-btn');

            if (prevBtn && wrapper) {
                prevBtn.addEventListener('click', () => {
                    const scrollAmount = -400;
                    wrapper.scrollBy({ left: scrollAmount, behavior: 'smooth' });
                });
            }

            if (nextBtn && wrapper) {
                nextBtn.addEventListener('click', () => {
                    const scrollAmount = 400;
                    wrapper.scrollBy({ left: scrollAmount, behavior: 'smooth' });
                });
            }
        });

        // Action button functionality
        $(document).on('click', '.rewrite-btn', function() {
            alert('Rewrite functionality would regenerate the answer with AI.');
        });

        $(document).on('click', '.share-btn', function() {
            // Copy current page URL to clipboard
            const url = window.location.href;
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(url).then(() => {
                    alert('Link copied to clipboard!');
                });
            } else {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = url;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('Link copied to clipboard!');
            }
        });

        // Copy URL to clipboard function
        function copyToClipboard(text) {
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(text).then(() => {
                    alert('URL copied to clipboard!');
                });
            } else {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('URL copied to clipboard!');
            }
        }

        // Setup source filtering functionality
        function setupSourceFilters(block) {
            block.find('.filter-btn').on('click', function() {
                const filterType = $(this).data('filter');
                
                // Update active filter button
                block.find('.filter-btn').removeClass('active');
                $(this).addClass('active');
                
                // Apply filter logic
                applySourceFilter(block, filterType);
            });
        }

        // Apply source filtering
        function applySourceFilter(block, filterType) {
            const sourceItems = block.find('.source-item');
            const sourcesContent = block.find('.sources-content');
            
            // Store original order if not already stored
            if (!sourcesContent.data('original-order')) {
                const originalOrder = [];
                sourceItems.each(function(index) {
                    originalOrder.push({
                        element: $(this),
                        index: index,
                        timestamp: Date.now() - (Math.random() * 1000000), // Simulate different timestamps
                        relevance: Math.random() // Simulate relevance scores
                    });
                });
                sourcesContent.data('original-order', originalOrder);
            }
            
            const originalOrder = sourcesContent.data('original-order');
            let filteredItems = [];
            
            switch (filterType) {
                case 'all':
                    // Show all items in original order
                    filteredItems = originalOrder.map(item => item.element);
                    break;
                    
                case 'recent':
                    // Sort by timestamp (newest first)
                    filteredItems = [...originalOrder]
                        .sort((a, b) => b.timestamp - a.timestamp)
                        .map(item => item.element);
                    break;
                    
                case 'relevance':
                    // Sort by relevance score (highest first)
                    filteredItems = [...originalOrder]
                        .sort((a, b) => b.relevance - a.relevance)
                        .map(item => item.element);
                    break;
                    
                default:
                    filteredItems = originalOrder.map(item => item.element);
            }
            
            // Reorder the DOM
            const sourcesContainer = block.find('.sources-content');
            const header = sourcesContainer.find('.sources-tab-header');
            const itemsContainer = sourcesContainer.find('.source-item').parent();
            
            // Remove header temporarily
            header.detach();
            
            // Clear and re-add items in new order
            sourceItems.detach();
            filteredItems.forEach(item => {
                sourcesContainer.append(item);
            });
            
            // Re-add header at the top
            sourcesContainer.prepend(header);
            
            // Add visual feedback
            showFilterFeedback(filterType);
        }

        // Show filter feedback
        function showFilterFeedback(filterType) {
            let message = '';
            switch (filterType) {
                case 'all':
                    message = 'Showing all sources in original order';
                    break;
                case 'recent':
                    message = 'Sources sorted by recency (newest first)';
                    break;
                case 'relevance':
                    message = 'Sources sorted by relevance score (highest first)';
                    break;
            }
            
            // Create or update feedback element
            let feedbackEl = $('.filter-feedback');
            if (feedbackEl.length === 0) {
                feedbackEl = $('<div class="filter-feedback"></div>');
                $('body').append(feedbackEl);
            }
            
            feedbackEl.text(message).addClass('show');
            
            // Hide after 2 seconds
            setTimeout(() => {
                feedbackEl.removeClass('show');
            }, 2000);
        }

        // Initialize filters when page loads
        $(document).ready(function() {
            setupSourceFilters($('.answer-block'));
        });
    </script>
</body>
</html>
